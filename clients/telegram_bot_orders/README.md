# Telegram Bot Orders



Telegram-–±–æ—Ç –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –≤ Regos.



## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (ItemGroup) –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

- –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏-–Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ (ReplyKeyboard), –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ —Å —Ñ–æ—Ç–æ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º.

- –ö–æ—Ä–∑–∏–Ω–∞ –≤ Redis (TTL) –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —á–µ—Ä–µ–∑ DocOrderDelivery/AddFull.

- –ú–æ–∏ –∑–∞–∫–∞–∑—ã: —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π.

- –ö–∞—Ä—Ç—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—è —Å –±–∞–ª–∞–Ω—Å–æ–º –∏ QR-–∫–æ–¥–æ–º (—à—Ç—Ä–∏—Ö-–∫–æ–¥ –∫–∞—Ä—Ç—ã).

- –ü—Ä–∏–≤—è–∑–∫–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∫ Telegram —á–µ—Ä–µ–∑ `field_telegram_id` (–ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞).

- –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É.



## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (ConnectedIntegrationSetting)

- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞.

- `PRICE_TYPE_ID` ‚Äî –≤–∏–¥ —Ü–µ–Ω—ã.

- `STOCK_ID` - —Å–∫–ª–∞–¥.

- `STOCK_ID_QUANTITY` - —Å–∫–ª–∞–¥ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ –≤—Å–µ–º —Å–∫–ª–∞–¥–∞–º).

- `SHOW_ZERO_QUANTITY` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã —Å –Ω—É–ª–µ–≤—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏.

- `SHOW_WITHOUT_IMAGES` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

- `ORDER_SOURCE_ID` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –∑–∞–∫–∞–∑–∞ (`from_id`).

- `MIN_ORDER_AMOUNT` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ (0 ‚Äî –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è).

- `WORK_TIME_ENABLED` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (true/false).

- `WORK_TIME_START` ‚Äî –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã (—Ñ–æ—Ä–º–∞—Ç `HH:MM`).

- `WORK_TIME_END` ‚Äî –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã (—Ñ–æ—Ä–º–∞—Ç `HH:MM`).

- `CUSTOMER_GROUP_ID` - –≥—Ä—É–ø–ø–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è.

- `WELCOME_MESSAGE` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ (–µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ).

- `DELIVERY_TYPE_REQUIRED` - –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ (true/false).

- `ADDRESS_REQUIRED` - –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∞–¥—Ä–µ—Å —Ç–µ–∫—Å—Ç–æ–º (true/false).

- `ITEM_GROUP_IDS` - —Å–ø–∏—Å–æ–∫ ID –≥—Ä—É–ø–ø —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–µ—Å–ª–∏ –ø—É—Å—Ç–æ, –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ).

- `CATALOG_PAGE_SIZE` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5).

- `ORDERS_DISABLED` - –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –ø—Ä–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ (–¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—è).
- `ORDER_STATE_TTL` - –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–∫–∞–∑–∞ –≤ Redis (—Å–µ–∫—É–Ω–¥—ã).

–ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–æ `ORDER_STATE_TTL`:
- –ó–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–∞–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (ConnectedIntegrationSetting) –∫–∞–∫ —á–∏—Å–ª–æ —Å–µ–∫—É–Ω–¥.
- –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –∑–∞–¥–∞–Ω –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ <= 0, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ `TelegramBotOrdersConfig.ORDER_STATE_TTL`.












## –†–µ–∂–∏–º –ø–æ–ª—É—á–µ–Ω–∏—è –∞–ø–¥–µ–π—Ç–æ–≤ Telegram

–ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `config/settings.py`:

- `telegram_update_mode = "webhook"` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–±—Ö—É–∫.

- `telegram_update_mode = "longpolling"` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å longpolling (–≤–µ–±—Ö—É–∫ —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).



## UX –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è

- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏ –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ ReplyKeyboardMarkup.

- –ö–∞—Ç–∞–ª–æ–≥:

  - —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è;

  - —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞–º–∏-–Ω–∞–∑–≤–∞–Ω–∏—è–º–∏;

  - –Ω–∞–∂–∞–Ω–∏–µ –Ω–∞ —Ç–æ–≤–∞—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É (—Ñ–æ—Ç–æ + –æ–ø–∏—Å–∞–Ω–∏–µ);

  - –ø–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ –∫–Ω–æ–ø–∫–∞–º ¬´–ù–∞–∑–∞–¥/–í–ø–µ—Ä—ë–¥¬ª.

- –ö–æ—Ä–∑–∏–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ —á–µ–∫–∞:

  - –ø–æ–∑–∏—Ü–∏–∏ —Å ‚ùå, —Ä–∞–∑–¥–µ–ª–µ–Ω—ã `----`;

  - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Ü–µ–Ω–∞ –∏ —Å—É–º–º–∞ ‚Äî –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö;

  - –æ—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É üóë.



## –§–ª–æ—É –∑–∞–∫–∞–∑–∞

1) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞. –ï—Å–ª–∏ —Ç–∞—Ä–∏—Ñ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `field_telegram_id`, –±–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –ø–æ –Ω–µ–º—É –∏ –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–æ–º–µ—Ä –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏. –ï—Å–ª–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è —á–∞—Ç–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Redis ‚Äî –±–æ—Ç –ø—Ä–æ—Å–∏—Ç ¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º¬ª.
2) –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞:
   - –Ω–æ–º–µ—Ä –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã);
   - –ø–æ–∏—Å–∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∏–¥–µ—Ç –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É (`main_phone`, –∑–∞—Ç–µ–º `search`);
   - –µ—Å–ª–∏ —É –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã –¥–æ–ø. –ø–æ–ª—è –∏ –µ—Å—Ç—å `field_telegram_id`, –±–æ—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ;
   - –µ—Å–ª–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π (–±–µ–∑ –¥–æ–ø. –ø–æ–ª–µ–π, –µ—Å–ª–∏ —Ç–∞—Ä–∏—Ñ –∏—Ö –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç).
3) –ö–∞—Ç–∞–ª–æ–≥: –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É.
4) –ö–æ—Ä–∑–∏–Ω–∞: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞, —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π, –æ—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã.
5) –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –º–∏–Ω. —Å—É–º–º—ã ‚Üí –∑–∞–ø—Ä–æ—Å —Å–ø–æ—Å–æ–±–∞ –¥–æ—Å—Ç–∞–≤–∫–∏/–∞–¥—Ä–µ—Å–∞ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ) ‚Üí –ª–æ–∫–∞—Ü–∏—è ‚Üí –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å) ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ DocOrderDelivery/AddFull.
6) –ö–∞—Ä—Ç—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—è: –≤—ã–±–æ—Ä –ø–æ `customer_id`, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∏ QR –∏–∑ `barcode_value`.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º –±–µ–∑ –¥–æ–ø. –ø–æ–ª–µ–π:
- `field_telegram_id` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–¥–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É.
- –ï—Å–ª–∏ –∫–µ—à —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏—Å—Ç–µ–∫ –∏–ª–∏ –æ—á–∏—â–µ–Ω, –±–æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç –Ω–æ–º–µ—Ä —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- –î–∞–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ Redis (–Ω–µ–±–æ–ª—å—à–æ–π TTL).

- –ö–æ—Ä–∑–∏–Ω–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Redis.

- QR-–∫–æ–¥—ã –∫–∞—Ä—Ç —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `qrcode` + `pillow` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
